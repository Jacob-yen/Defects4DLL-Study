Traceback (most recent call last):
  File "/root/anaconda3/envs/tf-36037-buggy/lib/python3.7/site-packages/tensorflow_core/python/framework/tensor_util.py", line 324, in _AssertCompatible
    fn(values)
  File "/root/anaconda3/envs/tf-36037-buggy/lib/python3.7/site-packages/tensorflow_core/python/framework/tensor_util.py", line 263, in inner
    _ = [_check_failed(v) for v in nest.flatten(values)
  File "/root/anaconda3/envs/tf-36037-buggy/lib/python3.7/site-packages/tensorflow_core/python/framework/tensor_util.py", line 264, in <listcomp>
    if not isinstance(v, expected_types)]
  File "/root/anaconda3/envs/tf-36037-buggy/lib/python3.7/site-packages/tensorflow_core/python/framework/tensor_util.py", line 248, in _check_failed
    raise ValueError(v)
ValueError: 0.0

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "./tf-36037-original.py", line 15, in <module>
    fx.test_relu()
  File "/root/anaconda3/envs/tf-36037-buggy/lib/python3.7/site-packages/tensorflow_core/python/framework/test_util.py", line 1109, in decorated
    f(self, *args, **kwargs)
  File "./tf-36037-original.py", line 12, in test_relu
    y = keras.layers.ReLU(max_value=100, dtype='int64')(x)
  File "/root/anaconda3/envs/tf-36037-buggy/lib/python3.7/site-packages/tensorflow_core/python/keras/engine/base_layer.py", line 793, in __call__
    outputs = call_fn(cast_inputs, *args, **kwargs)
  File "/root/anaconda3/envs/tf-36037-buggy/lib/python3.7/site-packages/tensorflow_core/python/keras/layers/advanced_activations.py", line 350, in call
    threshold=self.threshold)
  File "/root/anaconda3/envs/tf-36037-buggy/lib/python3.7/site-packages/tensorflow_core/python/keras/backend.py", line 4428, in relu
    zero = _constant_to_tensor(0., x.dtype.base_dtype)
  File "/root/anaconda3/envs/tf-36037-buggy/lib/python3.7/site-packages/tensorflow_core/python/keras/backend.py", line 678, in _constant_to_tensor
    return constant_op.constant(x, dtype=dtype)
  File "/root/anaconda3/envs/tf-36037-buggy/lib/python3.7/site-packages/tensorflow_core/python/framework/constant_op.py", line 258, in constant
    allow_broadcast=True)
  File "/root/anaconda3/envs/tf-36037-buggy/lib/python3.7/site-packages/tensorflow_core/python/framework/constant_op.py", line 296, in _constant_impl
    allow_broadcast=allow_broadcast))
  File "/root/anaconda3/envs/tf-36037-buggy/lib/python3.7/site-packages/tensorflow_core/python/framework/tensor_util.py", line 451, in make_tensor_proto
    _AssertCompatible(values, dtype)
  File "/root/anaconda3/envs/tf-36037-buggy/lib/python3.7/site-packages/tensorflow_core/python/framework/tensor_util.py", line 331, in _AssertCompatible
    (dtype.name, repr(mismatch), type(mismatch).__name__))
TypeError: Expected int64, got 0.0 of type 'float' instead.