Traceback (most recent call last):
  File "tf-46321-original.py", line 22, in <module>
    partitionedCallTest.test_mixed_float16_policy()
  File "tf-46321-original.py", line 18, in test_mixed_float16_policy
    layer([q, v, k])
  File "/home/jiangtianjie/anaconda3/envs/tf-gpu-2.4.3/lib/python3.8/site-packages/tensorflow/python/keras/engine/base_layer.py", line 1012, in __call__
    outputs = call_fn(inputs, *args, **kwargs)
  File "/home/jiangtianjie/anaconda3/envs/tf-gpu-2.4.3/lib/python3.8/site-packages/tensorflow/python/keras/layers/dense_attention.py", line 170, in call
    result, attention_scores = self._apply_scores(
  File "/home/jiangtianjie/anaconda3/envs/tf-gpu-2.4.3/lib/python3.8/site-packages/tensorflow/python/keras/layers/dense_attention.py", line 129, in _apply_scores
    scores -= 1.e9 * math_ops.cast(padding_mask, dtype=K.floatx())
  File "/home/jiangtianjie/anaconda3/envs/tf-gpu-2.4.3/lib/python3.8/site-packages/tensorflow/python/ops/math_ops.py", line 1164, in binary_op_wrapper
    return func(x, y, name=name)
  File "/home/jiangtianjie/anaconda3/envs/tf-gpu-2.4.3/lib/python3.8/site-packages/tensorflow/python/util/dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "/home/jiangtianjie/anaconda3/envs/tf-gpu-2.4.3/lib/python3.8/site-packages/tensorflow/python/ops/math_ops.py", line 561, in subtract
    return gen_math_ops.sub(x, y, name)
  File "/home/jiangtianjie/anaconda3/envs/tf-gpu-2.4.3/lib/python3.8/site-packages/tensorflow/python/ops/gen_math_ops.py", line 10307, in sub
    _ops.raise_from_not_ok_status(e, name)
  File "/home/jiangtianjie/anaconda3/envs/tf-gpu-2.4.3/lib/python3.8/site-packages/tensorflow/python/framework/ops.py", line 6862, in raise_from_not_ok_status
    six.raise_from(core._status_to_exception(e.code, message), None)
  File "<string>", line 3, in raise_from
tensorflow.python.framework.errors_impl.InvalidArgumentError: cannot compute Sub as input #1(zero-based) was expected to be a half tensor but is a float tensor [Op:Sub]